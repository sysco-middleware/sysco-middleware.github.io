I"õ<p>Requirement:
So, you have a need for transferring files via SFTP in OSB 12c to the clientâ€™s SFTP endpoint location.
This post can help you in couple of easy steps.</p>

<p>I presume you have access to your weblogic server file system where your integration will be deployed and of course the SFTP host endpoint where the files will be sent to.</p>

<blockquote>
  <p><strong>â€œThis is a work of fiction. Service names, IPâ€™s, business services, endpoints, hostnames and ports are either the products of the authorâ€™s imagination or used in a fictitious manner. Any resemblance to actual public keys, living or dead server IPâ€™s, or actual hosts is purely coincidental.â€</strong></p>
</blockquote>

<p>Solution:
As a first step letâ€™s open the JDeveloper and create/configure everything we need for OSB 12c project part.
Inside the OSB project design view in the External Services lane do a right click for an options menu.
Here we will use SFTP Transfer option and create a new Business service which will be then used for sending messages via Routing activity.
Hover over the â€˜Insert Transportsâ€™ and click on the â€˜SFTPâ€™.</p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/SFTP_Transport.jpg" alt="" /></p>

<p>Next step is to setup the Business Service for the SFTP. Just follow the next images from the Wizard.</p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/SFTP_BS_Wizard_1.jpg" alt="" /></p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/SFTP_BS_Wizard_2.jpg" alt="" /></p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/SFTP_BS_Wizard_3.jpg" alt="" /></p>

<p>For the SFTP Host name example letâ€™s use: <strong>sftp-endpoint-example-dev.org</strong></p>

<p>Folder name that will contain the sent messages is: <strong>folderName</strong></p>

<p>This information will be probably provided by your client/customer.</p>

<p>As a last step we need to configure the business serviceâ€™s Transport properties.  Open your business service and select the Transport Details (image below).
Add the Service account with the correct credentials that your SFTP is using.
And the most important property to set is the â€œ<strong>Preferred Public Key Algorithm</strong>â€, which you can set based on the what algorithm is used for the Public Key for the SSH. Here in this example I have both â€˜dssâ€™ and â€˜rssâ€™ key algorithms and I will use rss.</p>

<p><em>Later on I will show you how you can obtain the Public Key with a simple one liner command.</em></p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/SFTPTransportConfiguration.jpg" alt="" /></p>

<p>Now your business service is ready to be used inside OSB 12c pipeline.</p>

<p>Step two:</p>

<p>Now we have to deal with the â€˜known_hostsâ€™ file which should be located on weblogic.
In 12c this is the location where the â€˜known_hostsâ€™ file should be located:</p>

<p><strong>/u01/oracle/config/domains/osbdomain/config/osb/transports/sftp</strong></p>

<p>The main thing is to find â€˜osbdomain/configâ€™ folders on the server file system, and probably you will be missing some of the folders â€˜osb/transport/sftpâ€™ which you will then need to create.
In case you are not missing these folders then probably there is â€˜known_hostsâ€™ file already created, if not you will need to create it.
Now open the â€˜known_hostsâ€™ file and add the ssh Public Key for the rss algorithm including the IP of the server where the messages will be sent.</p>

<p>It has to look something like this:</p>

<p><img src="/images/2016-12-20-SFTP_Transfer_in_Oracle_Service_Bus_12c/KnownHostsFile.jpg" alt="" /></p>

<blockquote>
  <p><strong>Handle the â€˜known_hostsâ€™ file extra carefully, and make sure that file has no CR/LF at the end.
So the file should always be backed up before changing, or might even be added to subversion.</strong></p>
</blockquote>

<p>To obtain the SSH Public Key you need to GET public key (login to the weblogic with putty and run command from the root):</p>

<p><strong>ssh-keyscan -t rsa,dsa sftp-endpoint-example-dev.org</strong></p>

<p>As a last step you need to restart the managed servers on weblogic so the changes apply.
Now your Service Bus 12c project is ready to send the messages via SFTP.</p>

:ET